#!/bin/bash

main="$1"

# reset limits
ulimit -s unlimited

# prepare compilation
mkdir -p Build && $compiler -O3 -fopenmp -Werror -Wno-unused -fimplicit-none -Wall -fcheck=bound,do -ffpe-trap=invalid,zero,overflow -ffree-line-length-0 -mcmodel=large -I/usr/local/include/ -J"./Build" -c $main -o "Build/%e.o"

# compile
if [ "$compiler" = "gfortran-8" ]; then

    mkdir -p Build && \

        $compiler -O3 -fopenmp -Werror -Wno-unused -fimplicit-none -Wall -fcheck=bound,do -ffpe-trap=invalid,zero,overflow -mcmodel=large -ffree-line-length-0 -I/usr/local/include/ -J"./Build" -c $main -o "Build/%e.o" && \

        $compiler -O3 -fopenmp -J"./Build" /usr/local/include/toolbox.o "Build/%e.o" -o Build/prog
fi

# execute
./Build/prog
